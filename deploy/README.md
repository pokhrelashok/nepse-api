# NEPSE Portfolio API - Deployment Files\n\nThis directory contains all deployment configurations and scripts for Ubuntu server deployment.\n\n## Directory Structure\n\n```\ndeploy/\n├── deploy-ubuntu.sh              # Main deployment script\n├── ecosystem.config.js           # PM2 process configuration\n├── .env.production              # Production environment variables\n├── docker-compose.production.yml # Docker production setup\n├── Dockerfile.production        # Production Docker image\n├── templates/                   # Configuration file templates\n│   ├── nginx-site.conf         # Nginx site configuration\n│   ├── nginx-rate-limit.conf   # Nginx rate limiting config\n│   ├── nepse-pm2.service       # Systemd service template\n│   ├── nepse-logrotate.conf    # Log rotation configuration\n│   └── nginx.conf.template     # Complete nginx config template\n└── scripts/                     # Utility scripts\n    ├── update-app.sh           # Application update script\n    ├── populate-initial-data.sh # Initial data population\n    ├── monitor.sh              # System monitoring script\n    └── healthcheck.sh          # Health check script\n```\n\n## Quick Deployment\n\n### 1. Ubuntu Server Deployment\n\n```bash\n# Make deployment script executable\nchmod +x deploy/deploy-ubuntu.sh\n\n# Run deployment (replace with your domain)\nsudo deploy/deploy-ubuntu.sh yourdomain.com\n\n# For localhost deployment\nsudo deploy/deploy-ubuntu.sh localhost\n```\n\n### 2. Docker Deployment\n\n```bash\n# Production Docker deployment\ndocker-compose -f deploy/docker-compose.production.yml up -d\n```\n\n## Configuration Files\n\n### Templates\nAll template files use placeholders that are replaced during deployment:\n- `DOMAIN_PLACEHOLDER` - Replaced with your domain name\n- `APP_USER_PLACEHOLDER` - Replaced with application user (`nepse`)\n- `APP_DIR_PLACEHOLDER` - Replaced with application directory (`/var/www/nepse-api`)\n\n### Scripts\nUtility scripts for maintenance and monitoring:\n- **update-app.sh** - Updates application code and restarts services\n- **populate-initial-data.sh** - Populates database with initial stock data\n- **monitor.sh** - Real-time system monitoring\n- **healthcheck.sh** - System health validation\n\n## Post-Deployment\n\n### Initial Setup\n```bash\n# Populate initial data\nsudo -u nepse /var/www/nepse-api/populate-data.sh\n\n# Check system status\nnepse-status\n```\n\n### Monitoring\n```bash\n# Live monitoring dashboard\n/var/www/nepse-api/scripts/monitor.sh --watch\n\n# Health check\n/var/www/nepse-api/scripts/healthcheck.sh\n```\n\n### Maintenance\n```bash\n# Update application\nsudo -u nepse /var/www/nepse-api/update.sh\n\n# View logs\nnepse-logs\n\n# PM2 management\nsudo -u nepse pm2 status\nsudo -u nepse pm2 restart all\n```\n\n## Customization\n\nTo customize the deployment:\n\n1. **Modify templates** in `templates/` directory\n2. **Update scripts** in `scripts/` directory  \n3. **Adjust ecosystem.config.js** for PM2 settings\n4. **Update .env.production** for environment variables\n\n## Security Features\n\n- ✅ Firewall configuration (UFW)\n- ✅ SSL/TLS with Let's Encrypt\n- ✅ Rate limiting and security headers\n- ✅ Non-root user execution\n- ✅ Log rotation and monitoring\n\n## Troubleshooting\n\nIf deployment fails:\n\n1. **Check logs**: `tail -f /var/log/nginx/error.log`\n2. **Verify permissions**: `ls -la /var/www/nepse-api/`\n3. **Test nginx config**: `nginx -t`\n4. **Check PM2 status**: `sudo -u nepse pm2 status`\n\nFor detailed troubleshooting, see the main [DEPLOYMENT.md](../DEPLOYMENT.md) file.\n"
